# 持久化

 [TOC]
 
> exchange
>> 交换器不设置持久，重启后exchange的元数据会丢失,消息不会丢失，后续也不能将消息发送到这个交换器中

> queue
>> 不设置持久，重启后队列的元数据会丢死，消息也会丢失

> message
>> 通过将消息的投递模式(BasicProperties 中的 deliver yMode 属性）设置为 2 即可实现消息的持久化 。 


即使三者都全部设置为持久了,依旧也可能丢数据
+ autoAck为true的时候,消费者还没有处理完就宕机 ，解决办法 设为false
+ rabbitMQ在将消息持久化到磁盘 还没有落盘 的时候 宕机，解决方法 ，设置镜像队列
+ 引入事务机制或者发送方确认机制

 
 
 
 
 
 

